

<meta charset="utf-8" />
<script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
<style>
	   ul {
      border: 1px solid black;
      padding: 10px;
      margin-bottom: 20px;
    }

    li {
      margin-bottom: 5px;
    }

    img {
      width: 25px;
      height: 25px;
      margin-right: 5px;
    }
</style>

<script>
 	   function data_kangsu(data){
		let body = data.response.body;
		let arr = body.items.item;
		let html = ''; 
		
		//이미지
		const images = {
				'맑음'           : 'https://cdn-icons-png.flaticon.com/128/3262/3262946.png',
				'흐림'           : 'https://cdn-icons-png.flaticon.com/128/2722/2722859.png',
				'구름많음'       : 'https://cdn-icons-png.flaticon.com/128/2722/2722836.png',
				'구름많고 비'    : 'https://cdn-icons-png.flaticon.com/128/2722/2722809.png',
				'구름많고 눈'    : 'https://cdn-icons-png.flaticon.com/128/2722/2722873.png',
				'구름많고 비/눈' : 'https://cdn-icons-png.flaticon.com/128/2722/2722873.png',
				'구름많고 소나기': 'https://cdn-icons-png.flaticon.com/128/2840/2840777.png',
				'흐리고 비'      : 'https://cdn-icons-png.flaticon.com/128/2722/2722809.png',
				'흐리고 눈'      : 'https://cdn-icons-png.flaticon.com/128/2722/2722873.png',
				'흐리고비/눈'    : 'https://cdn-icons-png.flaticon.com/128/2722/2722873.png',
				'흐리고 소나기'  : 'https://cdn-icons-png.flaticon.com/128/2841/2841125.png',
				'온도': 'https://cdn-icons-png.flaticon.com/128/3052/3052776.png'
		};
		
		arr.forEach(function (kos, index) {
			
			let currentDate = new Date(); // 현재 시간을 가져옵니다.

			let targetDates = []; // 3일 후부터 7일 후까지의 날짜를 담을 배열
			let days = ['일', '월', '화', '수', '목', '금', '토'];

			for (let i = 0; i <= 4; i++) {
			  let targetDate = new Date(currentDate);
			  targetDate.setDate(targetDate.getDate() + i); // i일 후의 날짜를 설정합니다.

			  let targetMonth = targetDate.getMonth() + 1;
			  let targetDay = targetDate.getDate();
			  let targetDayOfWeek = days[targetDate.getDay()];

			  targetDates.push({
			    date: `${targetMonth}-${targetDay}`,
			    dayOfWeek: targetDayOfWeek
			  }); // 3일 후의 요일을 가져옵니다.
			}
		    html += '<div>';
			html += '<ul>';
			html += `<li>지역코드       :${kos.regId}</li>`
			if (kos.wf3Am in images){
				let imagesSrc = images[kos.wf3Am]
				html += `<li>${targetDates[0].date}(${targetDates[0].dayOfWeek}) 오전 :<img src="${imagesSrc}">` ; 
			}
			if(kos.wf3Pm in images){
				let imagesSrc = images[kos.wf3Pm]
				html += `오후 :<img src="${imagesSrc}"</li>`;
			}
			if (kos.wf4Am in images){
				let imagesSrc = images[kos.wf4Am]
				html += `<li>${targetDates[1].date}(${targetDates[1].dayOfWeek}) 오전 :<img src="${imagesSrc}">` ; 
			}
			if(kos.wf4Pm in images){
				let imagesSrc = images[kos.wf4Pm]
				html += `오후 :<img src="${imagesSrc}"</li>`;
			}
			if (kos.wf5Am in images){
				let imagesSrc = images[kos.wf5Pm]
				html += `<li>${targetDates[2].date}(${targetDates[2].dayOfWeek}) 오전 :<img src="${imagesSrc}">` ; 
			}
			if(kos.wf5Pm in images){
				let imagesSrc = images[kos.wf5Pm]
				html += `오후 :<img src="${imagesSrc}"</li>`;
			}
			if (kos.wf6Am in images){
				let imagesSrc = images[kos.wf6Am]
				html += `<li>${targetDates[3].date}(${targetDates[3].dayOfWeek}) 오전 :<img src="${imagesSrc}">` ; 
			}
			if(kos.wf6Pm in images){
				let imagesSrc = images[kos.wf6Pm]
				html += `오후 :<img src="${imagesSrc}"</li>`;
			}
			if (kos.wf7Am in images){
				let imagesSrc = images[kos.wf7Am]
				html += `<li>${targetDates[4].date}(${targetDates[4].dayOfWeek}) 오전 :<img src="${imagesSrc}">` ; 
			}
			if(kos.wf7Pm in images){
				let imagesSrc = images[kos.wf7Pm]
				html += `오후 :<img src="${imagesSrc}"</li>`;
			}
						
			html += '</ul>';
			html += '</div>';
		});
		
		return html;
	}  
 	   function data_gion(data){
		let body = data.response.body;
		let arr = body.items.item;
		let html = ''; 
		arr.forEach(function (kos, index) {
			let currentDate = new Date(); // 현재 시간을 가져옵니다.

			let targetDates = []; // 3일 후부터 7일 후까지의 날짜를 담을 배열
			let days = ['일', '월', '화', '수', '목', '금', '토'];

			for (let i = 3; i <= 7; i++) {
			  let targetDate = new Date(currentDate);
			  targetDate.setDate(targetDate.getDate() + i); // i일 후의 날짜를 설정합니다.

			  let targetMonth = targetDate.getMonth() + 1;
			  let targetDay = targetDate.getDate();
			  let targetDayOfWeek = days[targetDate.getDay()];

			  targetDates.push({
			    date: `${targetMonth}-${targetDay}`,
			    dayOfWeek: targetDayOfWeek
			  }); // 3일 후의 요일을 가져옵니다.
			}
			
			html += '<div>';
			html += '<ul>';
			html += `<li>지역코드       :${kos.regId}</li>`
			
			html += `<li>${targetDates[0].date}(${targetDates[0].dayOfWeek})` 
			html += `최저기온 :${kos.taMin3}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png">` 
			html += `최고기온 :${kos.taMax3}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png"></li>`
			html += `<li>${targetDates[1].date}(${targetDates[1].dayOfWeek})` 
			html += `최저기온 :${kos.taMin4}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png">` 
			html += `최고기온 :${kos.taMax4}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png"></li>`
			html += `<li>${targetDates[2].date}(${targetDates[2].dayOfWeek})` 
			html += `최저기온 :${kos.taMin5}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png">` 
			html += `최고기온 :${kos.taMax5}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png"></li>`
			html += `<li>${targetDates[3].date}(${targetDates[3].dayOfWeek})` 
			html += `최저기온 :${kos.taMin6}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png">` 
			html += `최고기온 :${kos.taMax6}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png"></li>`
			html += `<li>${targetDates[4].date}(${targetDates[4].dayOfWeek})` 
			html += `최저기온 :${kos.taMin7}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png">` 
			html += `최고기온 :${kos.taMax7}<img src="https://cdn-icons-png.flaticon.com/128/3052/3052776.png"></li>`
			
						
			html += '</ul>';
			html += '</div>';
		});
		return html;
	}  
	  
 	  $(document).ready(function() {
 		  let url1 = 'http://localhost:9090/gisang';
 		  let url2 = 'http://localhost:9090/gion';

 		  let ajax1 = $.ajax({
 		    url: url1,
 		    data: {
 		      keyword: $('#search').val()
 		    },
 		    dataType: "json",
 	        contentType: "application/x-www-form-urlencoded; charset=UTF-8"
 		  });

 		  let ajax2 = $.ajax({
 		    url: url2,
 		    data: {
 		      keyword: $('#search').val()
 		    },
 		    dataType: "json",
 		    contentType: "application/x-www-form-urlencoded; charset=UTF-8"
 		  });

 		  $.when(ajax1, ajax2).done(function(data1, data2) {
 		    let html1 = data_kangsu(data1[0]);
 		    let html2 = data_gion(data2[0]);
 		    $('#div1').html(html1 + html2);
 		  }).fail(function(xhr) {
 		    console.log(xhr);
 		    alert(xhr.status + ':' + xhr.textStatus);
 		  });
 		});
 	
 	
</script>
	
